---
title: " "
format: html
execute:
  echo: false
  warning: false
  message: false
---

```{python}
import pandas as pd
import matplotlib.pyplot as plt
from io import BytesIO
import base64

# CSV laden
csv_path = "/content/drive/MyDrive/Colab Notebooks/Unicef_Indicator_Meta_Merged.csv"
df = pd.read_csv(csv_path)

# Aggregieren
gender_counts = df.groupby("sex")["obs_value"].sum()
colors = ["#d9b4a9", "#8d6c64"]

# Kreisdiagramm
fig, ax = plt.subplots(figsize=(7, 7), facecolor="#fdf9f7")
wedges, texts, autotexts = ax.pie(
    gender_counts,
    labels=gender_counts.index,
    autopct=lambda p: f"{p:.1f}%\n({int(p * sum(gender_counts) / 100):,})".replace(",", "."),
    colors=colors,
    startangle=90,
    textprops={"color": "white", "fontsize": 14, "weight": "bold"}
)

# Labels
for text in texts:
    text.set_fontsize(14)
    text.set_color("#8d6c64")
    text.set_fontweight("bold")

# Nur DIESER Titel unter dem Kreisdiagramm
ax.text(0, -1.15, "Gender Distribution of Youth Mortality", 
        ha='center', fontsize=16, color="#8d6c64", weight='regular')

fig.patch.set_facecolor("none")
plt.tight_layout()

# Diagramm als Base64
buffer = BytesIO()
fig.savefig(buffer, format="png", bbox_inches="tight", transparent=True)
buffer.seek(0)
img_base64 = base64.b64encode(buffer.read()).decode("utf-8")
plt.close(fig)
```

```{python}
from IPython.display import display, HTML

display(HTML(f"""
<div style="text-align: center; font-family: sans-serif; background-color: #fdf9f7; padding: 30px;">
  <h2 style="color: #8d6c64; font-weight: 600; font-size: 28px; margin-bottom: 5px;">
    Youth Mortality: A Global Crisis? How Many Have Died in the Last 32 Years?
  </h2>
  <h3 style="color: #8d6c64; font-weight: 400; font-size: 22px; margin-top: 0;">
    The Global Picture
  </h3>

  <img src="data:image/png;base64,{img_base64}" alt="Gender Distribution Pie Chart" style="width: 380px; margin-top: 20px;">

  <p style="color: #8d6c64; font-size: 18px; margin-top: 30px;">
    Nearly <strong>50 million</strong> young people <strong>between the ages 15 and 24</strong> have died worldwide over the past <strong>32 years</strong>.<br>
    <strong>60%</strong> of these deaths were <strong>male</strong>, while <strong>40%</strong> were <strong>female</strong>.
  </p>

  <p style="color: #8d6c64; font-size: 18px; font-style: italic; font-weight: 600;">
    Let's delve deeper into these numbers!
  </p>
</div>
"""))
```

```{python}
import plotly.graph_objects as go
import plotly.io as pio

pio.renderers.default = 'notebook_connected'

# Einheitliche Hintergrundfarbe
background = "#fdf9f7"

# Länder
countries = [
    "India", "China", "Nigeria", "Ethiopia", "Pakistan", "Indonesia",
    "Bangladesh", "United States", "Russia", "South Africa",
    "Sudan", "Uganda", "Mexico", "Angola", "Philippines"
]

# Manuell zugewiesene Farbwerte (0–1)
z = [
    1.0,   # Indien
    0.95,  # China
    0.8,   # Nigeria
    0.75,  # Ethiopia
    0.7,   # Pakistan
    0.65,  # Indonesia
    0.6,   # Bangladesh
    0.55,  # USA
    0.5,   # Russia
    0.45,  # South Africa
    0.4,   # Sudan
    0.35,  # Uganda
    0.3,   # Mexico
    0.25,  # Angola
    0.05   # Philippines
]

# Echte Todeszahlen (für Hover)
values = [
    11669299, 4009047, 2346690, 1720761, 1689171, 1596339,
    1256822, 1095822, 1030063, 912404,
    700600, 699347, 667463, 596003, 581688
]

ranks = list(range(1, 16))

# Farbschema
custom_brown = [
    [0.0, "#f9f6f4"],
    [0.25, "#f2e9e4"],
    [0.5, "#ddb8a0"],
    [0.7, "#c58a6a"],
    [0.85, "#874c3c"],
    [0.95, "#5e2f23"],
    [1.0, "#3e1d17"]
]

# Korrekte Tick-Positionen für 2–10 Mio
tickvals = [0.134, 0.298, 0.463, 0.628, 0.793]
ticktext = ["2 Mio", "4 Mio", "6 Mio", "8 Mio", "10 Mio"]

# Plot erstellen
fig = go.Figure()

fig.add_trace(
    go.Choropleth(
        locations=countries,
        locationmode="country names",
        z=z,
        zmin=0,
        zmax=1,
        colorscale=custom_brown,
        colorbar=dict(
            title="Total Deaths",
            len=0.8,
            tickvals=tickvals,
            ticktext=ticktext,
            tickfont=dict(color="#8d6c64", size=14),
            title_font=dict(color="#8d6c64", size=16),
            title_side="top"
        ),
        marker_line_color="black",
        marker_line_width=0.5,
        text=[
            f"<b>Rank:</b> {rank}<br><b>Country:</b> {country}<br><b>Total Deaths:</b> {val:,}"
            for country, val, rank in zip(countries, values, ranks)
        ],
        hoverinfo="text"
    )
)

# Layout und Styling
fig.update_layout(
    title="Top 15 Countries with the Highest Youth Mortality (1990–2022)",
    title_font=dict(size=22, family="Arial", color="#8d6c64", weight="bold"),
    font=dict(family="Arial", size=14, color="#8d6c64"),
    geo=dict(
        projection=dict(type="orthographic", rotation=dict(lon=60, lat=12)),
        showland=True,
        landcolor="whitesmoke",
        showocean=True,
        oceancolor="rgba(173, 216, 230, 0.2)",
        showlakes=True,
        lakecolor="rgba(173, 216, 230, 0.2)",
        showcountries=True,
        countrycolor="white",
        showframe=False,
        showcoastlines=False,
        bgcolor=background
    ),
    paper_bgcolor=background,
    plot_bgcolor=background,
    margin={"r": 0, "t": 50, "l": 0, "b": 0}
)

fig.show()
```


<div style="background-color: #fdf9f7; color: #8d6c64; font-family: sans-serif; font-size: 16px; padding: 20px; max-width: 1250px; margin: 0 auto; text-align: left;">
  <p>
    For the sake of simplicity, this map highlights the <strong>15 countries</strong> with the 
    <strong>highest absolute number of youth mortality</strong> (ages 15–24) from 1990 to 2022.
  </p>
  <p>
    The darkest colours on the map indicate the countries with the most deaths. Unfortunately, 
    <strong>not all countries show a downward trend</strong>. Some are still struggling with problems that contribute 
    to persistently high mortality rates.
  </p>
  <p>
    While these absolute numbers indicate where the most deaths occurred, a mortality rate comparison 
    (per 100,000 population) would provide further insight into where youth mortality is proportionally highest.
  </p>
  <p style="color: #f28c28; font-style: italic; font-weight: bold;">
    Curious how this plays out worldwide?
  </p>
</div>

